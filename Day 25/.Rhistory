, c(6,-6,-1,2)
, c(-7,5,-3,7)
, c(5,7,-1,-2)
, c(6,-6,-5,8)
, c(4,-4,7,-3)
, c(-3,-1,-6,6)
, c(-8,8,-5,7)
, c(5,-1,-4,8)
, c(3,-7,5,0)
, c(-4,4,7,-8)
, c(-8,-5,-6,-6)
, c(-2,1,8,2)
, c(-3,0,7,0)
, c(7,-1,-5,-3)
, c(-3,-4,-1,1)
, c(3,0,-6,3)
, c(3,1,-2,-6)
, c(5,6,1,-2)
, c(8,3,-3,6)
, c(-5,4,6,1)
, c(-3,3,-3,-4)
, c(1,-6,-7,5)
, c(7,-8,7,-4)
, c(-3,3,-1,1)
, c(-4,-2,-3,4)
, c(4,8,5,1)
, c(8,-1,2,6)
, c(8,0,7,-3)
, c(0,-1,7,-2)
, c(1,7,8,0)
, c(-3,3,6,-6)
, c(-2,5,6,7)
, c(-5,4,-1,-6)
, c(0,8,1,0)
, c(2,5,-6,-5)
, c(0,0,3,7)
, c(-5,3,-6,-6)
, c(2,-2,0,1)
, c(8,-8,5,-8)
, c(-6,-1,2,1)
, c(-5,3,7,2)
, c(-2,7,-7,-1)
, c(-2,4,3,-8)
, c(4,0,0,-4)
, c(-5,6,6,-8)
, c(5,1,5,-3)
, c(1,-6,-4,8)
, c(0,0,-8,5)
, c(7,-6,-8,4)
, c(0,5,5,-7)
, c(1,0,0,4)
, c(5,7,-3,3)
, c(-5,5,-4,-8)
, c(-3,0,-8,5)
, c(4,5,6,5)
, c(-3,-5,8,-5)
, c(3,-1,3,3)
, c(0,-4,-1,-8)
, c(-8,5,3,7)
, c(-7,-6,2,-7)
, c(-1,5,-3,-6)
, c(-7,1,2,0)
, c(1,8,0,0)
, c(0,-8,-2,3)
, c(0,-1,7,-8)
, c(-4,-8,1,8)
, c(6,2,-5,2)
, c(0,-6,-1,0)
, c(4,7,4,7)
, c(-6,7,-7,2)
, c(-7,-1,-1,-5)
, c(-2,6,7,-4)
, c(3,4,4,3)
, c(0,-7,2,1)
, c(-4,8,-3,-7)
, c(4,8,-7,-7)
, c(4,-7,6,-8)
, c(-4,-6,-2,1)
, c(-4,-2,-7,2)
, c(3,6,7,-1)
, c(-6,-4,-6,-1)
, c(-6,1,-7,8)
, c(-4,0,1,-4)
, c(0,1,-8,-4)
, c(-4,-3,-5,-2)
, c(4,-2,4,-4)
, c(5,3,1,-3)
, c(-6,7,7,-3)
, c(-5,5,-8,5)
, c(1,-6,-7,3)
, c(6,-3,-7,0)
, c(0,-6,2,8)
, c(0,0,2,5)
, c(-7,1,2,-8)
, c(-7,0,-5,-6)
, c(0,8,7,-4)
, c(-8,1,-6,-1)
, c(-3,4,7,-8)
, c(7,-8,0,-8)
, c(3,8,-3,-1)
, c(0,4,0,2)
, c(7,3,2,-2)
, c(3,0,6,-2)
, c(4,-2,0,2)
, c(0,-5,8,-1)
, c(6,2,0,5)
, c(-8,1,-1,-1)
, c(-8,-3,-3,4)
, c(1,0,8,6)
, c(-6,-8,-1,8)
, c(2,1,-3,5)
, c(-8,0,-4,-8)
, c(6,0,1,-8)
, c(0,3,-5,0)
, c(3,-4,-7,-8)
, c(-7,0,-8,7)
, c(7,8,5,8)
, c(-1,1,6,-8)
, c(0,6,7,0)
, c(-2,-5,-1,4)
, c(-2,1,2,-3)
, c(0,-7,3,-8)
, c(8,-8,7,-2)
, c(-8,-6,-4,-1)
, c(0,2,-8,-2)
, c(4,6,8,-2)
, c(-5,-3,3,-6)
, c(-7,0,0,-6)
, c(0,-7,6,4)
, c(7,6,0,4)
, c(-1,-7,4,6)
, c(-2,2,-3,4)
, c(-8,-3,2,-8)
, c(-5,-6,-7,-5)
, c(-4,-8,-2,-5)
, c(0,4,-7,0)
, c(6,2,-4,0)
, c(-2,1,-7,7)
, c(7,-3,1,-5)
, c(-6,-1,-7,-1)
, c(-1,-6,6,7)
, c(8,-7,8,2)
, c(-4,0,8,6)
, c(-8,-3,-3,1)
, c(3,2,-3,1)
, c(8,-2,5,-5)
, c(5,-7,1,6)
, c(3,-5,5,-3)
, c(-6,6,0,-5)
, c(-1,-2,1,5)
, c(-1,-3,4,-4)
, c(-5,5,0,8)
, c(5,2,2,-1)
, c(4,-1,7,-7)
, c(6,-8,-4,3)
, c(-8,6,-6,-4)
, c(-7,-7,-4,1)
, c(-4,1,8,5)
, c(0,-3,6,3)
, c(-5,0,-4,0)
, c(3,-6,-8,3)
, c(6,0,-2,7)
, c(1,3,-3,-2)
, c(-4,0,4,6)
, c(7,0,-8,6)
, c(0,0,-8,0)
, c(-4,2,0,-6)
, c(2,6,5,-3)
, c(3,-7,8,-1)
, c(0,-8,8,3)
, c(-8,-3,-4,4)
, c(6,2,-2,-5)
, c(2,-5,3,8)
, c(0,-8,3,4)
, c(-2,7,-6,2)
, c(6,0,4,-6)
, c(4,-7,5,-8)
, c(-8,6,1,7)
, c(-7,7,3,-2)
, c(1,4,4,5)
, c(-6,8,-3,4)
, c(-5,0,8,-3)
, c(3,2,6,8)
, c(-7,7,0,4)
, c(-4,2,3,4)
, c(-1,-5,3,-3)
, c(6,3,-2,-5)
, c(-1,1,1,2)
, c(-8,-8,6,-8)
, c(-1,3,3,7)
, c(0,-6,-6,6)
, c(-7,0,4,5)
, c(2,0,0,1)
, c(-1,-8,5,0)
, c(0,0,-3,7)
, c(2,-1,-7,-5)
, c(-4,-5,-6,1)
, c(8,8,-1,0)
, c(6,8,5,-5)
, c(0,1,7,1)
, c(-7,1,4,-7)
, c(-6,-7,-3,1)
, c(3,-2,2,-3)
, c(-5,2,8,-7)
, c(7,-5,7,-1)
, c(-7,4,6,-3)
, c(5,0,-3,1)
, c(6,-4,-1,0)
, c(-2,5,1,4)
, c(2,0,-6,-4)
, c(0,-2,-4,-3)
, c(-2,5,4,-7)
, c(2,-5,0,-5)
, c(-8,0,-3,3)
, c(-7,-5,5,-7)
, c(1,-2,-2,-7)
, c(6,0,0,1)
, c(0,8,5,-2)
, c(-8,0,-2,-5)
, c(-7,-3,-6,7)
, c(6,-8,-1,-6)
, c(0,5,8,-6)
, c(-8,-4,-4,-2)
, c(8,7,1,5)
, c(3,1,1,-5)
, c(1,-5,-6,-4)
, c(2,5,6,4)
, c(6,-8,3,3)
, c(-5,-5,4,8)
, c(-3,0,8,7)
, c(-3,4,7,-2)
, c(-8,5,-5,0)
, c(8,-1,-2,2)
, c(-6,-6,4,8)
, c(1,-8,-3,-2)
, c(7,1,4,0)
, c(1,0,-7,-8)
, c(2,6,-2,4)
, c(-8,3,6,-4)
, c(-7,1,4,6)
, c(8,1,8,5)
, c(8,-8,7,3)
, c(-3,0,-5,6)
, c(4,2,-2,2)
, c(-5,-7,0,-5)
, c(-5,7,8,-2)
, c(-4,0,7,0)
, c(0,0,4,-2)
, c(-6,5,-7,-1)
, c(0,5,-7,-6)
, c(5,-1,4,4)
, c(4,-8,8,-8)
, c(-3,-3,-4,-5)
, c(8,-7,6,5)
, c(-5,2,-8,-7)
, c(-1,-8,1,6)
, c(-7,0,-3,-3)
, c(5,6,8,0)
, c(-3,-6,-6,-8)
, c(1,-7,0,-1)
, c(-8,-1,-6,6)
, c(6,0,-7,7)
, c(6,-5,-7,-7)
, c(3,-7,7,-6)
, c(6,-2,-8,-7)
, c(8,2,-2,8)
, c(-5,2,4,-7)
, c(0,-8,-1,1)
, c(-4,-6,6,-2)
, c(-2,-7,6,0)
, c(-8,-6,-7,-8)
, c(2,-6,8,8)
, c(0,-1,8,8)
, c(-2,0,0,8)
, c(-2,-1,2,0)
, c(-7,8,5,0)
, c(3,-8,5,4)
, c(-4,5,4,-4)
, c(-6,3,5,0)
, c(-7,-6,0,5)
, c(-2,7,7,-6)
, c(-3,0,5,-6)
, c(-2,-7,-5,-7)
, c(-4,-4,-3,0)
, c(3,0,-1,-1)
, c(8,-3,5,-6)
, c(-8,3,5,-4)
, c(1,5,8,6)
, c(6,4,1,-2)
, c(-8,6,2,2)
, c(-1,3,-7,-2)
, c(5,4,4,8)
, c(-7,5,8,2)
, c(-3,-4,-2,7)
, c(-8,4,7,2)
, c(-5,-6,8,-8)
, c(-4,-4,-2,8)
, c(0,-4,-3,0)
, c(-8,1,4,0)
, c(-8,4,6,2)
, c(7,1,3,-3)
, c(0,8,7,-5)
, c(5,-3,4,-7)
, c(7,-6,4,6)
, c(0,0,-7,7)
, c(5,-2,3,0)
, c(1,-4,-4,6)
, c(4,2,6,-5)
, c(7,2,1,3)
, c(-7,-1,-2,6)
, c(-7,3,2,3)
, c(5,7,6,1)
, c(-2,1,-5,2)
, c(-1,5,5,-7)
, c(-2,0,2,4)
, c(2,1,7,-4)
, c(4,-7,-2,-3)
, c(4,4,8,-8)
, c(3,-3,0,-2)
, c(-1,3,3,8)
, c(0,7,-7,7)
, c(6,-7,0,-4)
, c(2,0,-4,-6)
, c(7,-8,-5,-6)
, c(0,0,-5,1)
, c(5,1,-7,-6)
, c(0,-7,0,4)
, c(7,2,6,1)
, c(5,-4,4,-7)
, c(-1,2,-7,2)
, c(0,-3,2,3)
, c(-3,1,5,-1)
, c(8,-8,0,-4)
, c(-3,-8,2,2)
, c(-5,5,-4,6)
, c(6,-5,6,3)
, c(5,1,-6,1)
, c(-5,-2,-3,-5)
, c(7,2,4,8)
, c(-2,1,6,-8)
, c(-2,4,-8,7)
, c(-5,-1,7,-5)
, c(-2,-4,-2,-2)
, c(-4,-7,1,-5)
, c(-4,0,-3,-4)
, c(0,-3,0,-1)
, c(1,0,0,-1)
, c(-2,-8,-3,-4)
, c(4,0,7,6)
, c(5,-6,-6,-7)
, c(-8,-4,4,-1)
, c(4,-7,1,5)
, c(7,0,2,8)
, c(-7,0,-3,-8)
, c(0,6,-8,-5)
, c(-5,-7,-4,0)
, c(1,1,3,2)
, c(4,0,-2,-8)
, c(-5,3,0,7)
, c(0,-8,-7,2)
, c(-2,-8,-1,6)
, c(0,1,5,0)
, c(2,7,-5,-7)
, c(5,0,-6,0)
, c(2,7,0,1)
, c(0,1,-5,-1)
, c(8,3,-2,5)
, c(0,2,-1,0)
, c(-1,5,2,3)
, c(-3,3,1,-8)
, c(5,6,-4,-1)
, c(-8,-7,1,-3)
, c(4,1,-8,-1)
, c(3,4,3,0)
, c(7,7,-8,0)
, c(-2,-8,2,3)
, c(-3,-1,-2,-8)
, c(4,-6,0,7)
, c(3,1,0,-2)
, c(-1,0,-5,3)
, c(-6,3,-7,1)
, c(4,1,3,-3)
, c(5,4,-6,1)
, c(-1,8,0,8)
, c(-8,3,-2,0)
, c(7,6,4,0)
, c(-6,-2,3,-1)
, c(-6,-2,8,5)
, c(7,-8,1,-8)
, c(-8,6,2,-6)
, c(-1,7,-7,-8)
, c(-1,-5,2,3)
, c(-1,0,-4,6)
, c(3,-2,6,5)
, c(3,-5,1,8)
, c(7,0,-2,6)
, c(0,7,8,7)
, c(8,3,2,0)
, c(4,0,-1,-1)
, c(5,4,6,7)
, c(8,-1,-5,-1)
, c(-4,-7,3,-6)
, c(-4,8,3,-7)
, c(-5,0,8,1)
, c(8,5,3,7)
, c(2,3,-6,4)
, c(5,7,-2,-2)
, c(2,-5,-3,8)
, c(1,0,4,5)
, c(0,6,-3,2)
, c(1,1,0,5)
, c(7,-1,-1,0)
, c(4,-4,-1,4)
, c(7,6,-8,3)
, c(-4,8,0,-3)
, c(0,2,3,-4)
, c(-1,-7,6,5)
, c(6,3,-2,-3)
, c(7,8,0,-4)
, c(-8,6,8,0)
, c(4,0,8,0)
, c(-2,8,8,5)
, c(-7,1,-8,-7)
, c(6,8,-3,5)
, c(5,0,-7,5)
, c(0,-3,-4,-8)
, c(3,-8,0,-8)
, c(-7,6,-1,8)
, c(5,0,-3,-7)
, c(-6,6,-1,-3)
, c(-4,-8,3,-6)
, c(6,0,7,0)
, c(3,-1,7,6)
, c(0,3,-7,-5)
, c(-4,-2,6,2)
, c(-5,-6,8,-5)
, c(3,8,2,-1)
, c(0,7,1,6)
, c(8,1,0,4)
, c(-4,-6,6,4)
, c(-8,7,-7,3)
, c(7,4,0,2)
, c(-7,7,3,-7)
, c(3,5,-6,-2)
, c(-1,-2,-2,-7)
, c(0,0,8,3)
, c(1,7,8,8)
, c(0,2,0,-3)
, c(5,-1,3,-7)
, c(5,-8,-3,4)
, c(2,-6,1,0)
, c(5,-8,-2,-3)
, c(1,-5,-8,-2)
, c(6,-1,3,1)
, c(-3,-4,6,0)
, c(1,-4,7,-1)
, c(1,0,1,0)
, c(4,-3,2,-2)
, c(-6,-7,7,-7)
, c(7,-4,-2,2)
, c(-8,-5,7,-5)
, c(5,4,7,7)
, c(6,2,-6,0)
, c(0,3,-4,4)
, c(6,1,1,0)
, c(-1,-8,8,4)
, c(-5,5,-2,5)
, c(3,-1,3,-7)
, c(4,0,8,7)
, c(-6,-2,0,7)
, c(-4,-7,6,-6)
, c(-6,4,-7,8)
, c(7,7,-5,4)
, c(-3,-6,-3,-4)
, c(0,-3,-2,0)
, c(2,4,0,1)
, c(8,5,-1,6)
, c(1,2,-6,-2)
, c(-8,7,0,5)
))
# Find Manhattan distance
for(i in 1:nrow(dat)){
col_nm <- paste0('Dist_' , i)
dat[[col_nm]] <- abs(dat$V1 - dat$V1[i]) + abs(dat$V2 - dat$V2[i]) + abs(dat$V3 - dat$V3[i]) + abs(dat$V4 - dat$V4[i])
}
# Confirm is Manhattan distance is within 3 to define constellation
for(i in 1:nrow(dat)){
col_nm <- paste0('Dist_' , i)
col_nm_chk <- paste0('Dist_' , i, '_Chk')
dat[[col_nm_chk]] <- ifelse(dat[[col_nm]] <= 3, 1, 0)
}
# Get only the distance "check" columns and turn into tabular formuat
num_coords <- nrow(dat)
num_cols <- ncol(dat)
dat_chk <- dat[, (num_cols - num_coords + 1):num_cols]
dat_chk$coord1 <- 1:nrow(dat_chk)
dat_melt <- melt(dat_chk, id.vars = c('coord1'))
dat_melt$coord2 <- sort(rep(1:num_coords, num_coords))
dat_melt <- dat_melt[c('coord1','coord2','value')]
# Find group
start_grp <- 1
grps <- as.data.frame(cbind(1:num_coords, rep(NA, num_coords)))
names(grps) <- c('coord','group')
for(i in 1:num_coords){
df <- dat_melt %>%
filter(coord1 == i, value != 0) %>%
select(coord2) %>%
unlist
grps[df, 'group'] <- min(grps[df, 'group'], start_grp, na.rm = TRUE)
start_grp <- start_grp + 1
}
length(unique(grps$group)) # 8
